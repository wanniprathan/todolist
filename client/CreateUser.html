<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />    
    <title>Create user</title>    
    <script src="superfetch.js"></script>
     <link rel="stylesheet" href="style.css">
</head>

<body>

        
        <br>
        <br>
        <br>
        <br>
        <input id="inpname" type="text" placeholder="User name" />
        <input id="inpass" type="password" placeholder="password" />
        <input id="inpfullname" type="text" placeholder="full name" />
    <br>
        <button id="btnCreate1">Create</button>
        <p class="message">I have an account: <a href="index.html">logg inn</a></p>
    
        <h2 id="txtinfo"></h2>
      
       
    
    
 
    
</body>
<script>
    
    var inpname = document.getElementById("inpname");
    var inpass = document.getElementById("inpass");
    var inpfullname = document.getElementById("inpfullname");        
    var btnCreate1 = document.getElementById("btnCreate1"); 
    var txtinfo = document.getElementById("txtinfo"); 
    
    
    
    btnCreate1.onclick = function() { 
        
        
        var upload = JSON.stringify({            
            loginname: inpname.value,
            password: inpass.value,
            fullname: inpfullname.value            
        });       
        
        //var url = "https://todolistvol2.herokuapp.com/users/";
        
        var url = "http://localhost:3001/users/";

        var cfg = {
            method: "POST",            
            body: upload
        }    

      superfetch(url, "json", succ, error, cfg);
    }
         
        
  
    
    function succ(data) {
        console.log(data);
        
        if(data.msg == "Ugyldig brukernavn!!"){
            //alert("Brukeren finnes fra før");
            
            txtinfo.innerHTML = "Brukeren finnes fra før!";
        }
        else{
        
        
        
        //window.location.assign("http://todolistvol2.herokuapp.com/loginUser");
        window.location.assign("http://localhost:3001/index.html");
        }
      
    }
    
    function error(err) {
        console.log(err);
         txtinfo.innerHTML = "Denne brukeren finnes fra før"
    }

    //txtinfo.innerHTML = "Brukeren, " + data.loginname + ", er oppretted. Fullt navn " + data.fullname;  


</script>

</html>